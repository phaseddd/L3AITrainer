# 实操题2 - 智能训练

## 注意事项

1. 进入元实操环境后，在试题描述内容的上方有对本题所涉及的资源文件的使用说明。使用试题资源文件时，请将资源文件拷贝至系统"桌面"文件夹后使用，切勿在资源文件的当前目录进行使用。题干以"资源包"表示资源文件拷贝后存放的文件夹路径。

2. 进入元实操环境后，如 `C:\Project\2` 文件夹及其子文件夹不存在，请手动创建。

3. **重要：** `C:\Project\2` 文件夹内请仅保留试题要求保存的文件最终版本，且该文件夹的所有（包括子文件夹）文件的大小总计不得超过100MB。

## 试题2、智能训练

**（1）本题分值：** 35分

**（2）具体考核要求：** 某企业研发了一套基于文本内容的邮件过滤系统，用于自动区分垃圾邮件与正常邮件。现需对该系统进行性能评估与优化。请按照以下要求完成算法测试和优化。

### a）数据准备与划分

① **打开代码：** `资源包\题目2\2-1划分数据.py`

② **读取数据集：** 从 `资源包\题目2\邮件数据.csv` 文件中读取所有文本数据。数据包含两列：
   - `text`（邮件文本）
   - `label`（标签，1表示垃圾邮件，0表示非垃圾邮件）

③ **数据清洗与划分：**
   - 去除文本中的特殊符号（如标点符号、HTML标签等）
   - 将文本转换为小写
   - 去除停用词（可以使用 nltk 库中的停用词表）
   - 将上述数据按照 7:3 的比例随机划分为训练集和测试集

④ **保存结果：**
   - 训练集保存至：`C:\Project\2\训练集\清洗后邮件数据_train.csv`
   - 测试集保存至：`C:\Project\2\测试集\清洗后邮件数据_test.csv`

### b）模型训练

① **新建并编写** `2-2训练模型.py`

② **导入预训练模型：** 使用 transformers 库中的 `DistilBertForSequenceClassification` 作为预训练模型

③ **读取数据和数据预处理：**
   - 使用上一步划分好的训练集作为模型训练数据
   - 使用 `DistilBertTokenizer` 对文本进行分词和编码
   - 将数据转换为模型输入格式（如 `input_ids`、`attention_mask`）

④ **训练并保存模型：**
   - 设置超参数：
     - 学习率为 `1e-5`
     - 批次大小为 `10`
     - 训练轮数为 `4`
   - 使用 `AdamW` 优化器进行训练
   - 训练完成后，将训练得到的模型命名为 `2-2model_test.bin` 并保存到 `C:\Project\2` 文件夹下

### c）模型测试与结果提交

① **打开** `资源包\题目2\2-3 测试模型效果.py`

② **补充完善代码：** 使用经过训练并保存的模型（`2-2model_test.bin`），并计算：
   - 准确率
   - 精确率
   - 召回率
   - F1 分数

③ **结果记录：** 请将预测的准确率及实验分析细节记录，并保存到 `C:\Project\2\model_test_result.txt` 文件中。

---

**参考答案：** 详见素材文件"题目2_参考答案.zip"。